
<!DOCTYPE html>


<html lang="es" data-content_root="../../" >

  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" /><meta name="viewport" content="width=device-width, initial-scale=1" />

    <title>Stable_Diffusion_GPU_vs_CPU &#8212; Programación Distribuida 2025 - 02 Ucaldas</title>
  
  
  
  <script data-cfasync="false">
    document.documentElement.dataset.mode = localStorage.getItem("mode") || "";
    document.documentElement.dataset.theme = localStorage.getItem("theme") || "";
  </script>
  
  <!-- Loaded before other Sphinx assets -->
  <link href="../../_static/styles/theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/bootstrap.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
<link href="../../_static/styles/pydata-sphinx-theme.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />

  
  <link href="../../_static/vendor/fontawesome/6.5.2/css/all.min.css?digest=dfe6caa3a7d634c4db9b" rel="stylesheet" />
  <link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-solid-900.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-brands-400.woff2" />
<link rel="preload" as="font" type="font/woff2" crossorigin href="../../_static/vendor/fontawesome/6.5.2/webfonts/fa-regular-400.woff2" />

    <link rel="stylesheet" type="text/css" href="../../_static/pygments.css?v=fa44fd50" />
    <link rel="stylesheet" type="text/css" href="../../_static/styles/sphinx-book-theme.css?v=eba8b062" />
    <link rel="stylesheet" type="text/css" href="../../_static/togglebutton.css?v=13237357" />
    <link rel="stylesheet" type="text/css" href="../../_static/copybutton.css?v=76b2166b" />
    <link rel="stylesheet" type="text/css" href="../../_static/mystnb.8ecb98da25f57f5357bf6f572d296f466b2cfe2517ffebfabe82451661e28f02.css?v=6644e6bb" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-thebe.css?v=4fa983c6" />
    <link rel="stylesheet" type="text/css" href="../../_static/sphinx-design.min.css?v=95c83b7e" />
  
  <!-- Pre-loaded scripts that we'll load fully later -->
  <link rel="preload" as="script" href="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b" />
<link rel="preload" as="script" href="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b" />
  <script src="../../_static/vendor/fontawesome/6.5.2/js/all.min.js?digest=dfe6caa3a7d634c4db9b"></script>

    <script src="../../_static/documentation_options.js?v=78d55cf8"></script>
    <script src="../../_static/doctools.js?v=9a2dae69"></script>
    <script src="../../_static/sphinx_highlight.js?v=dc90522c"></script>
    <script src="../../_static/clipboard.min.js?v=a7894cd8"></script>
    <script src="../../_static/copybutton.js?v=f281be69"></script>
    <script src="../../_static/scripts/sphinx-book-theme.js?v=887ef09a"></script>
    <script>let toggleHintShow = 'Click to show';</script>
    <script>let toggleHintHide = 'Click to hide';</script>
    <script>let toggleOpenOnPrint = 'true';</script>
    <script src="../../_static/togglebutton.js?v=4a39c7ea"></script>
    <script src="../../_static/translations.js?v=d190bf04"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script src="../../_static/design-tabs.js?v=36754332"></script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script async="async" src="../../_static/sphinx-thebe.js?v=c100c467"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown';</script>
    <script>const THEBE_JS_URL = "https://unpkg.com/thebe@0.8.2/lib/index.js"; const thebe_selector = ".thebe,.cell"; const thebe_selector_input = "pre"; const thebe_selector_output = ".output, .cell_output"</script>
    <script>DOCUMENTATION_OPTIONS.pagename = 'Unidades/Unidad_10/Stable_Diffusion_GPU_vs_CPU_working';</script>
    <link rel="index" title="Índice" href="../../genindex.html" />
    <link rel="search" title="Búsqueda" href="../../search.html" />
  <meta name="viewport" content="width=device-width, initial-scale=1"/>
  <meta name="docsearch:language" content="es"/>
  </head>
  
  
  <body data-bs-spy="scroll" data-bs-target=".bd-toc-nav" data-offset="180" data-bs-root-margin="0px 0px -60%" data-default-mode="">

  
  
  <div id="pst-skip-link" class="skip-link d-print-none"><a href="#main-content">Saltar al contenido principal</a></div>
  
  <div id="pst-scroll-pixel-helper"></div>
  
  <button type="button" class="btn rounded-pill" id="pst-back-to-top">
    <i class="fa-solid fa-arrow-up"></i>Volver arriba</button>

  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-primary-sidebar-checkbox"/>
  <label class="overlay overlay-primary" for="pst-primary-sidebar-checkbox"></label>
  
  <input type="checkbox"
          class="sidebar-toggle"
          id="pst-secondary-sidebar-checkbox"/>
  <label class="overlay overlay-secondary" for="pst-secondary-sidebar-checkbox"></label>
  
  <div class="search-button__wrapper">
    <div class="search-button__overlay"></div>
    <div class="search-button__search-container">
<form class="bd-search d-flex align-items-center"
      action="../../search.html"
      method="get">
  <i class="fa-solid fa-magnifying-glass"></i>
  <input type="search"
         class="form-control"
         name="q"
         id="search-input"
         placeholder="Search this book..."
         aria-label="Search this book..."
         autocomplete="off"
         autocorrect="off"
         autocapitalize="off"
         spellcheck="false"/>
  <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd>K</kbd></span>
</form></div>
  </div>

  <div class="pst-async-banner-revealer d-none">
  <aside id="bd-header-version-warning" class="d-none d-print-none" aria-label="Advertencia de versión"></aside>
</div>

  
    <header class="bd-header navbar navbar-expand-lg bd-navbar d-print-none">
    </header>
  

  <div class="bd-container">
    <div class="bd-container__inner bd-page-width">
      
      
      
        
      
      <div class="bd-sidebar-primary bd-sidebar">
        

  
  <div class="sidebar-header-items sidebar-primary__section">
    
    
    
    
  </div>
  
    <div class="sidebar-primary-items__start sidebar-primary__section">
        <div class="sidebar-primary-item">

  
    
  

<a class="navbar-brand logo" href="../../intro.html">
  
  
  
  
  
    
    
      
    
    
    <img src="https://avatars.githubusercontent.com/u/142033488?s=200&v=4" class="logo__image only-light" alt="Programación Distribuida 2025 - 02 Ucaldas - Home"/>
    <script>document.write(`<img src="https://avatars.githubusercontent.com/u/142033488?s=200&v=4" class="logo__image only-dark" alt="Programación Distribuida 2025 - 02 Ucaldas - Home"/>`);</script>
  
  
</a></div>
        <div class="sidebar-primary-item">

 <script>
 document.write(`
   <button class="btn search-button-field search-button__button" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass"></i>
    <span class="search-button__default-text">Búsqueda</span>
    <span class="search-button__kbd-shortcut"><kbd class="kbd-shortcut__modifier">Ctrl</kbd>+<kbd class="kbd-shortcut__modifier">K</kbd></span>
   </button>
 `);
 </script></div>
        <div class="sidebar-primary-item"><nav class="bd-links bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item navbar-nav active">
        
        <ul class="nav bd-sidenav bd-sidenav__home-link">
            <li class="toctree-l1">
                <a class="reference internal" href="../../intro.html">
                    Programación Concurrente y Distribuida
                </a>
            </li>
        </ul>
        <ul class="nav bd-sidenav">
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Unidad1.html">Unidad 1: Clusters en computación paralela/distribuida</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Unidad_1/repasoPythonC.html">Repaso Python y C para programación concurrente y distribuida</a></li>



<li class="toctree-l2"><a class="reference internal" href="../Unidad_1/Tema%201%20-%20TiposDeDatos%20Condicionales%20Ciclos%20Colecciones%20Funciones_10_08_2023.html"><strong>Introducción</strong></a></li>



























<li class="toctree-l2"><a class="reference internal" href="../Unidad_1/Tema_1_1_2_Multiples_Lenguajes_en_Colab_17_08_2023.html">Ejecución de código en multiples lenguajes de programación</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Unidad_1/Tema%202%20-%20Arreglos_10_08_2023.html">Matrices y vectores</a></li>







<li class="toctree-l2"><a class="reference internal" href="../Unidad_1/Intro_pandas.html">Introducción a Pandas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Unidad_1/Data_filtering_and_cleaning.html">«Data cleaning» y «Filtros»</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Unidad_1/Tema%204%20-%20Analisis%20numerico%20y%20Calculo%20simbolico%20con%20Sympy_04_09_2024.html">Algebra computacional con <code class="docutils literal notranslate"><span class="pre">Sympy</span></code></a></li>

<li class="toctree-l2"><a class="reference internal" href="../Unidad_1/VisualizacionDinamicaFoliumF.html">Visualizaciones Avanzadas</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Unidad_1/Automatizaciones.html">Automatizaciones</a></li>



<li class="toctree-l2"><a class="reference internal" href="../Unidad_1/Ficheros.html">Manejo de ficheros</a></li>




</ul>
</details></li>
<li class="toctree-l1"><a class="reference internal" href="../../Unidad2.html">Unidad 2: Arquitecturas para computación paralela</a></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Unidad3.html">Unidad 3: Métricas de desempeño</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Unidad_3/Ejercicio.html">Ejercicio</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Unidad_3/Ley_de_Amdahl_Gustafson_Ejercicio.html">Ley de Amdahl y Gustafson</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Unidad_3/CalculodeFLOPS.html">Precisión Simple Vs Precisión Doble y TFlops</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Unidad_3/Metricas%20programas%20paralelos.html">Medidas de desempeño</a></li>
<li class="toctree-l2"><a class="reference internal" href="../Unidad_3/Recursos%20Extra.html">Recursos Extra</a></li>
</ul>
</details></li>
<li class="toctree-l1 has-children"><a class="reference internal" href="../../Unidad4.html">Unidad 4: Hilos</a><details><summary><span class="toctree-toggle" role="presentation"><i class="fa-solid fa-chevron-down"></i></span></summary><ul>
<li class="toctree-l2"><a class="reference internal" href="../Unidad_5/Hilos_en_Python.html">Hilos en Python</a></li>

</ul>
</details></li>
</ul>

    </div>
</nav></div>
    </div>
  
  
  <div class="sidebar-primary-items__end sidebar-primary__section">
  </div>
  
  <div id="rtd-footer-container"></div>


      </div>
      
      <main id="main-content" class="bd-main" role="main">
        
        

<div class="sbt-scroll-pixel-helper"></div>

          <div class="bd-content">
            <div class="bd-article-container">
              
              <div class="bd-header-article d-print-none">
<div class="header-article-items header-article__inner">
  
    <div class="header-article-items__start">
      
        <div class="header-article-item"><button class="sidebar-toggle primary-toggle btn btn-sm" title="Toggle primary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
  <span class="fa-solid fa-bars"></span>
</button></div>
      
    </div>
  
  
    <div class="header-article-items__end">
      
        <div class="header-article-item">

<div class="article-header-buttons">





<div class="dropdown dropdown-launch-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Launch interactive content">
    <i class="fas fa-rocket"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://colab.research.google.com/github/BioAITeamLearning/ProgCD_2025_01_Ucaldas/blob/main/Unidades/Unidad_10/Stable_Diffusion_GPU_vs_CPU_working.ipynb" target="_blank"
   class="btn btn-sm dropdown-item"
   title="Launch on Colab"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  
    <img alt="Colab logo" src="../../_static/images/logo_colab.png">
  </span>
<span class="btn__text-container">Colab</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-source-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Source repositories">
    <i class="fab fa-github"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="https://github.com/BioAITeamLearning/ProgCD_2025_01_Ucaldas" target="_blank"
   class="btn btn-sm btn-source-repository-button dropdown-item"
   title="Repositorio de origen"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fab fa-github"></i>
  </span>
<span class="btn__text-container">Repository</span>
</a>
</li>
      
      
      
      
      <li><a href="https://github.com/BioAITeamLearning/ProgCD_2025_01_Ucaldas/issues/new?title=Issue%20on%20page%20%2FUnidades/Unidad_10/Stable_Diffusion_GPU_vs_CPU_working.html&body=Your%20issue%20content%20here." target="_blank"
   class="btn btn-sm btn-source-issues-button dropdown-item"
   title="Abrir un problema"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-lightbulb"></i>
  </span>
<span class="btn__text-container">Open issue</span>
</a>
</li>
      
  </ul>
</div>






<div class="dropdown dropdown-download-buttons">
  <button class="btn dropdown-toggle" type="button" data-bs-toggle="dropdown" aria-expanded="false" aria-label="Descarga esta pagina">
    <i class="fas fa-download"></i>
  </button>
  <ul class="dropdown-menu">
      
      
      
      <li><a href="../../_sources/Unidades/Unidad_10/Stable_Diffusion_GPU_vs_CPU_working.ipynb" target="_blank"
   class="btn btn-sm btn-download-source-button dropdown-item"
   title="Descargar archivo fuente"
   data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file"></i>
  </span>
<span class="btn__text-container">.ipynb</span>
</a>
</li>
      
      
      
      
      <li>
<button onclick="window.print()"
  class="btn btn-sm btn-download-pdf-button dropdown-item"
  title="Imprimir en PDF"
  data-bs-placement="left" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-file-pdf"></i>
  </span>
<span class="btn__text-container">.pdf</span>
</button>
</li>
      
  </ul>
</div>




<button onclick="toggleFullScreen()"
  class="btn btn-sm btn-fullscreen-button"
  title="Modo de pantalla completa"
  data-bs-placement="bottom" data-bs-toggle="tooltip"
>
  

<span class="btn__icon-container">
  <i class="fas fa-expand"></i>
  </span>

</button>



<script>
document.write(`
  <button class="btn btn-sm nav-link pst-navbar-icon theme-switch-button" title="claro/oscuro" aria-label="claro/oscuro" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="theme-switch fa-solid fa-sun fa-lg" data-mode="light"></i>
    <i class="theme-switch fa-solid fa-moon fa-lg" data-mode="dark"></i>
    <i class="theme-switch fa-solid fa-circle-half-stroke fa-lg" data-mode="auto"></i>
  </button>
`);
</script>


<script>
document.write(`
  <button class="btn btn-sm pst-navbar-icon search-button search-button__button" title="Búsqueda" aria-label="Búsqueda" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <i class="fa-solid fa-magnifying-glass fa-lg"></i>
  </button>
`);
</script>
<button class="sidebar-toggle secondary-toggle btn btn-sm" title="Toggle secondary sidebar" data-bs-placement="bottom" data-bs-toggle="tooltip">
    <span class="fa-solid fa-list"></span>
</button>
</div></div>
      
    </div>
  
</div>
</div>
              
              

<div id="jb-print-docs-body" class="onlyprint">
    <h1>Stable_Diffusion_GPU_vs_CPU</h1>
    <!-- Table of contents -->
    <div id="print-main-content">
        <div id="jb-print-toc">
            
            <div>
                <h2> Contenido </h2>
            </div>
            <nav aria-label="Page">
                <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Stable_Diffusion_GPU_vs_CPU</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stable-diffusion-usando-una-gpu-en-google-colaboratory-con-cuda">Stable Diffusion usando una GPU en Google Colaboratory con CUDA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recuerda-activar-un-entorno-de-ejecucion-con-gpu">Recuerda activar un <strong>Entorno de ejecución</strong> con GPU.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#instalacion-de-librerias">Instalación de librerías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-de-librerias">Carga de librerías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verificacion-de-gpu-y-cuda">Verificación de GPU y CUDA</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stable-diffusion-funciones">Stable Diffusion funciones</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stable-diffusion-en-gpu">Stable Diffusion en GPU</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stable-diffusion-en-cpu">Stable Diffusion en CPU</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparemos-la-gpu-con-la-cpu">Comparemos la GPU con la CPU</a></li>
</ul>
</li>
</ul>

            </nav>
        </div>
    </div>
</div>

              
                
<div id="searchbox"></div>
                <article class="bd-article">
                  
  <section class="tex2jax_ignore mathjax_ignore" id="stable-diffusion-gpu-vs-cpu">
<h1>Stable_Diffusion_GPU_vs_CPU<a class="headerlink" href="#stable-diffusion-gpu-vs-cpu" title="Link to this heading">#</a></h1>
<section id="stable-diffusion-usando-una-gpu-en-google-colaboratory-con-cuda">
<h2>Stable Diffusion usando una GPU en Google Colaboratory con CUDA<a class="headerlink" href="#stable-diffusion-usando-una-gpu-en-google-colaboratory-con-cuda" title="Link to this heading">#</a></h2>
<p>Basado en <a class="reference external" href="https://pub.aimind.so/exploring-stable-diffusion-in-google-colab-using-cuda-a-step-by-step-tutorial-35452519fdeb">Exploring Stable Diffusion in Google Colab using CUDA: A Step-by-Step Tutorial</a></p>
<p>Se utilizará la GPU, esta aceleración de GPU accesible a través de Google Colab mejorará significativamente la velocidad del proceso. Sin una GPU, ejecutar el modelo en una CPU podría tomar aproximadamente de 100 veces más tiempo que si se usa una GPU.</p>
</section>
<section id="recuerda-activar-un-entorno-de-ejecucion-con-gpu">
<h2>Recuerda activar un <strong>Entorno de ejecución</strong> con GPU.<a class="headerlink" href="#recuerda-activar-un-entorno-de-ejecucion-con-gpu" title="Link to this heading">#</a></h2>
</section>
<section id="instalacion-de-librerias">
<h2>Instalación de librerías<a class="headerlink" href="#instalacion-de-librerias" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>pycuda
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>diffusers
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>transformers
<span class="o">!</span>pip<span class="w"> </span>install<span class="w"> </span>accelerate
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Requirement already satisfied: pycuda in /usr/lib/python3/dist-packages (2018.1.1)
Collecting diffusers
  Downloading diffusers-0.27.2-py3-none-any.whl (2.0 MB)
     |████████████████████████████████| 2.0 MB 1.8 MB/s eta 0:00:01
?25hRequirement already satisfied: numpy in /home/rtabares/.local/lib/python3.8/site-packages (from diffusers) (1.23.1)
Collecting filelock
  Downloading filelock-3.14.0-py3-none-any.whl (12 kB)
Requirement already satisfied: requests in /usr/local/lib/python3.8/dist-packages (from diffusers) (2.31.0)
Requirement already satisfied: importlib-metadata in /usr/local/lib/python3.8/dist-packages (from diffusers) (6.8.0)
Requirement already satisfied: Pillow in /home/rtabares/.local/lib/python3.8/site-packages (from diffusers) (10.1.0)
Collecting regex!=2019.12.17
  Downloading regex-2024.5.15-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (776 kB)
     |████████████████████████████████| 776 kB 2.1 MB/s eta 0:00:01
?25hCollecting safetensors&gt;=0.3.1
  Downloading safetensors-0.4.3-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (1.2 MB)
     |████████████████████████████████| 1.2 MB 42.3 MB/s eta 0:00:01
?25hCollecting huggingface-hub&gt;=0.20.2
  Downloading huggingface_hub-0.23.0-py3-none-any.whl (401 kB)
     |████████████████████████████████| 401 kB 42.3 MB/s eta 0:00:01
?25hRequirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/lib/python3/dist-packages (from requests-&gt;diffusers) (1.25.8)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.8/dist-packages (from requests-&gt;diffusers) (3.3.2)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/lib/python3/dist-packages (from requests-&gt;diffusers) (2.8)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/lib/python3/dist-packages (from requests-&gt;diffusers) (2019.11.28)
Requirement already satisfied: zipp&gt;=0.5 in /home/rtabares/.local/lib/python3.8/site-packages (from importlib-metadata-&gt;diffusers) (3.17.0)
Requirement already satisfied: typing-extensions&gt;=3.7.4.3 in /usr/local/lib/python3.8/dist-packages (from huggingface-hub&gt;=0.20.2-&gt;diffusers) (4.8.0)
Requirement already satisfied: pyyaml&gt;=5.1 in /usr/lib/python3/dist-packages (from huggingface-hub&gt;=0.20.2-&gt;diffusers) (5.3.1)
Requirement already satisfied: tqdm&gt;=4.42.1 in /home/rtabares/.local/lib/python3.8/site-packages (from huggingface-hub&gt;=0.20.2-&gt;diffusers) (4.66.2)
Requirement already satisfied: packaging&gt;=20.9 in /usr/local/lib/python3.8/dist-packages (from huggingface-hub&gt;=0.20.2-&gt;diffusers) (23.2)
Collecting fsspec&gt;=2023.5.0
  Downloading fsspec-2024.5.0-py3-none-any.whl (316 kB)
     |████████████████████████████████| 316 kB 34.3 MB/s eta 0:00:01
?25hInstalling collected packages: filelock, regex, safetensors, fsspec, huggingface-hub, diffusers
Successfully installed diffusers-0.27.2 filelock-3.14.0 fsspec-2024.5.0 huggingface-hub-0.23.0 regex-2024.5.15 safetensors-0.4.3
Collecting transformers
  Downloading transformers-4.41.0-py3-none-any.whl (9.1 MB)
     |████████████████████████████████| 9.1 MB 1.9 MB/s eta 0:00:01
?25hRequirement already satisfied: filelock in /home/rtabares/.local/lib/python3.8/site-packages (from transformers) (3.14.0)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.8/dist-packages (from transformers) (23.2)
Requirement already satisfied: safetensors&gt;=0.4.1 in /home/rtabares/.local/lib/python3.8/site-packages (from transformers) (0.4.3)
Collecting tokenizers&lt;0.20,&gt;=0.19
  Downloading tokenizers-0.19.1-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (3.6 MB)
     |████████████████████████████████| 3.6 MB 1.5 MB/s eta 0:00:01     |█████████████████████████████▎  | 3.3 MB 1.5 MB/s eta 0:00:01
?25hRequirement already satisfied: numpy&gt;=1.17 in /home/rtabares/.local/lib/python3.8/site-packages (from transformers) (1.23.1)
Requirement already satisfied: pyyaml&gt;=5.1 in /usr/lib/python3/dist-packages (from transformers) (5.3.1)
Requirement already satisfied: requests in /usr/local/lib/python3.8/dist-packages (from transformers) (2.31.0)
Requirement already satisfied: tqdm&gt;=4.27 in /home/rtabares/.local/lib/python3.8/site-packages (from transformers) (4.66.2)
Requirement already satisfied: huggingface-hub&lt;1.0,&gt;=0.23.0 in /home/rtabares/.local/lib/python3.8/site-packages (from transformers) (0.23.0)
Requirement already satisfied: regex!=2019.12.17 in /home/rtabares/.local/lib/python3.8/site-packages (from transformers) (2024.5.15)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/lib/python3/dist-packages (from requests-&gt;transformers) (1.25.8)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/lib/python3/dist-packages (from requests-&gt;transformers) (2.8)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.8/dist-packages (from requests-&gt;transformers) (3.3.2)
Requirement already satisfied: certifi&gt;=2017.4.17 in /usr/lib/python3/dist-packages (from requests-&gt;transformers) (2019.11.28)
Requirement already satisfied: typing-extensions&gt;=3.7.4.3 in /usr/local/lib/python3.8/dist-packages (from huggingface-hub&lt;1.0,&gt;=0.23.0-&gt;transformers) (4.8.0)
Requirement already satisfied: fsspec&gt;=2023.5.0 in /home/rtabares/.local/lib/python3.8/site-packages (from huggingface-hub&lt;1.0,&gt;=0.23.0-&gt;transformers) (2024.5.0)
Installing collected packages: tokenizers, transformers
Successfully installed tokenizers-0.19.1 transformers-4.41.0
Collecting accelerate
  Downloading accelerate-0.30.1-py3-none-any.whl (302 kB)
     |████████████████████████████████| 302 kB 1.2 MB/s eta 0:00:01
?25hCollecting torch&gt;=1.10.0
  Downloading torch-2.3.0-cp38-cp38-manylinux1_x86_64.whl (779.1 MB)
     |████████████████████████████████| 779.1 MB 50 kB/s  eta 0:00:011     |████▌                           | 109.4 MB 19.8 MB/s eta 0:00:34     |████████                        | 192.1 MB 14.4 MB/s eta 0:00:41     |██████████████████              | 439.6 MB 16.2 MB/s eta 0:00:21     |█████████████████████           | 509.8 MB 19.1 MB/s eta 0:00:15     |███████████████████████▌        | 571.8 MB 19.0 MB/s eta 0:00:11     |████████████████████████████▎   | 689.8 MB 16.7 MB/s eta 0:00:06
?25hRequirement already satisfied: numpy&gt;=1.17 in /home/rtabares/.local/lib/python3.8/site-packages (from accelerate) (1.23.1)
Requirement already satisfied: safetensors&gt;=0.3.1 in /home/rtabares/.local/lib/python3.8/site-packages (from accelerate) (0.4.3)
Requirement already satisfied: packaging&gt;=20.0 in /usr/local/lib/python3.8/dist-packages (from accelerate) (23.2)
Requirement already satisfied: huggingface-hub in /home/rtabares/.local/lib/python3.8/site-packages (from accelerate) (0.23.0)
Requirement already satisfied: psutil in /usr/local/lib/python3.8/dist-packages (from accelerate) (5.9.6)
Requirement already satisfied: pyyaml in /usr/lib/python3/dist-packages (from accelerate) (5.3.1)
Collecting nvidia-cudnn-cu12==8.9.2.26; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
  Downloading nvidia_cudnn_cu12-8.9.2.26-py3-none-manylinux1_x86_64.whl (731.7 MB)
     |████████████████████████████████| 731.7 MB 36 kB/s  eta 0:00:011MB 14.1 MB/s eta 0:00:42     |███████████                     | 253.4 MB 15.4 MB/s eta 0:00:32     |█████████████████▍              | 396.5 MB 13.9 MB/s eta 0:00:25�█▌ | 696.5 MB 14.3 MB/s eta 0:00:03
?25hCollecting triton==2.3.0; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot; and python_version &lt; &quot;3.12&quot;
  Downloading triton-2.3.0-cp38-cp38-manylinux_2_17_x86_64.manylinux2014_x86_64.whl (168.0 MB)
     |████████████████████████████████| 168.0 MB 130 kB/s  eta 0:00:01    |████████████████                | 84.5 MB 14.4 MB/s eta 0:00:06     |█████████████████▉              | 93.5 MB 14.3 MB/s eta 0:00:06�██████████▋        | 124.0 MB 16.3 MB/s eta 0:00:03��████▉        | 125.0 MB 16.3 MB/s eta 0:00:03
?25hCollecting nvidia-cuda-runtime-cu12==12.1.105; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
  Downloading nvidia_cuda_runtime_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (823 kB)
     |████████████████████████████████| 823 kB 1.9 MB/s eta 0:00:01��████▍                     | 266 kB 1.9 MB/s eta 0:00:01
?25hCollecting networkx
  Downloading networkx-3.1-py3-none-any.whl (2.1 MB)
     |████████████████████████████████| 2.1 MB 25.6 MB/s eta 0:00:01
?25hCollecting nvidia-cuda-cupti-cu12==12.1.105; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
  Downloading nvidia_cuda_cupti_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (14.1 MB)
     |████████████████████████████████| 14.1 MB 19.2 MB/s eta 0:00:01
?25hCollecting nvidia-cuda-nvrtc-cu12==12.1.105; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
  Downloading nvidia_cuda_nvrtc_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (23.7 MB)
     |████████████████████████████████| 23.7 MB 5.6 MB/s eta 0:00:011
?25hCollecting nvidia-cusparse-cu12==12.1.0.106; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
  Downloading nvidia_cusparse_cu12-12.1.0.106-py3-none-manylinux1_x86_64.whl (196.0 MB)
     |████████████████████████████████| 196.0 MB 89 kB/s s eta 0:00:018.4 MB 21.9 MB/s eta 0:00:09                           | 18.9 MB 21.9 MB/s eta 0:00:09     |███▉                            | 23.5 MB 21.9 MB/s eta 0:00:08                  | 58.7 MB 9.5 MB/s eta 0:00:15                  | 60.4 MB 9.5 MB/s eta 0:00:15�████████▍                     | 63.8 MB 12.4 MB/s eta 0:00:11��██████▌                    | 70.6 MB 12.4 MB/s eta 0:00:11██▉                   | 78.6 MB 12.4 MB/s eta 0:00:10███                   | 80.0 MB 8.7 MB/s eta 0:00:14ta 0:00:14     |███████████████▋                | 95.5 MB 8.7 MB/s eta 0:00:12     |██████████████████▎             | 112.1 MB 9.6 MB/s eta 0:00:09     |███████████████████▊            | 120.8 MB 30.9 MB/s eta 0:00:03��█████████████████▉            | 121.2 MB 30.9 MB/s eta 0:00:03:08█████████████████▋          | 132.6 MB 9.1 MB/s eta 0:00:07██████▊          | 133.1 MB 9.1 MB/s eta 0:00:07         | 133.5 MB 9.1 MB/s eta 0:00:07██████████████████          | 135.4 MB 9.1 MB/s eta 0:00:07███████▏         | 136.1 MB 9.1 MB/s eta 0:00:07/s eta 0:00:07█▊         | 138.8 MB 9.1 MB/s eta 0:00:07�████████████████▊         | 139.2 MB 9.1 MB/s eta 0:00:07██████████        | 147.5 MB 9.2 MB/s eta 0:00:06ta 0:00:02010:01:00:01 0:00:01
?25hRequirement already satisfied: jinja2 in /usr/local/lib/python3.8/dist-packages (from torch&gt;=1.10.0-&gt;accelerate) (3.1.2)
Requirement already satisfied: typing-extensions&gt;=4.8.0 in /usr/local/lib/python3.8/dist-packages (from torch&gt;=1.10.0-&gt;accelerate) (4.8.0)
Requirement already satisfied: filelock in /home/rtabares/.local/lib/python3.8/site-packages (from torch&gt;=1.10.0-&gt;accelerate) (3.14.0)
Collecting nvidia-curand-cu12==10.3.2.106; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
  Downloading nvidia_curand_cu12-10.3.2.106-py3-none-manylinux1_x86_64.whl (56.5 MB)
     |████████████████████████████████| 56.5 MB 30.8 MB/s eta 0:00:01.2 MB 38.9 MB/s eta 0:00:020:02                 | 16.3 MB 38.9 MB/s eta 0:00:02                | 16.7 MB 38.9 MB/s eta 0:00:0200:07�                      | 17.6 MB 6.4 MB/s eta 0:00:07                     | 18.1 MB 6.4 MB/s eta 0:00:07           | 18.9 MB 6.4 MB/s eta 0:00:06��██████████                     | 19.4 MB 6.4 MB/s eta 0:00:06��██████████▎                   | 21.6 MB 6.4 MB/s eta 0:00:060:06B 6.4 MB/s eta 0:00:06          | 22.9 MB 6.4 MB/s eta 0:00:06████████▍         | 39.5 MB 45.5 MB/s eta 0:00:01         | 40.2 MB 45.5 MB/s eta 0:00:01 | 46.2 MB 45.5 MB/s eta 0:00:01�� | 53.4 MB 30.8 MB/s eta 0:00:01
?25hCollecting nvidia-cufft-cu12==11.0.2.54; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
  Downloading nvidia_cufft_cu12-11.0.2.54-py3-none-manylinux1_x86_64.whl (121.6 MB)
     |████████████████████████████████| 121.6 MB 37.5 MB/s eta 0:00:01██                           | 18.9 MB 13.8 MB/s eta 0:00:08    |█████▌                          | 20.7 MB 13.8 MB/s eta 0:00:08    |██████████▎                     | 39.2 MB 16.4 MB/s eta 0:00:06��██████▎                    | 43.0 MB 16.4 MB/s eta 0:00:05     |██████████████▌                 | 55.3 MB 9.1 MB/s eta 0:00:08�██▉                | 60.1 MB 9.1 MB/s eta 0:00:07 0:00:0762.5 MB 9.1 MB/s eta 0:00:07��██▌               | 62.9 MB 9.1 MB/s eta 0:00:07:00:07�▏              | 65.1 MB 9.1 MB/s eta 0:00:07              | 65.5 MB 9.1 MB/s eta 0:00:078.2 MB 18.6 MB/s eta 0:00:03��█████████████████             | 71.8 MB 18.6 MB/s eta 0:00:03█████████████████▉          | 82.9 MB 18.6 MB/s eta 0:00:03     |██████████████████████▊         | 86.2 MB 13.7 MB/s eta 0:00:03�███████▉         | 86.7 MB 13.7 MB/s eta 0:00:03MB/s eta 0:00:02114.1 MB 20.3 MB/s eta 0:00:01████████████████████████████▌ | 115.9 MB 20.3 MB/s eta 0:00:01��███████████▎| 118.7 MB 20.3 MB/s eta 0:00:01�████████████▎| 119.0 MB 20.3 MB/s eta 0:00:01��██████████████| 121.5 MB 37.5 MB/s eta 0:00:01
?25hRequirement already satisfied: fsspec in /home/rtabares/.local/lib/python3.8/site-packages (from torch&gt;=1.10.0-&gt;accelerate) (2024.5.0)
Collecting nvidia-cusolver-cu12==11.4.5.107; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
  Downloading nvidia_cusolver_cu12-11.4.5.107-py3-none-manylinux1_x86_64.whl (124.2 MB)
     |████████████████████████████████| 124.2 MB 29 kB/s  eta 0:00:011                   | 307 kB 1.5 MB/s eta 0:01:21     |██▍                             | 9.5 MB 1.5 MB/s eta 0:01:15                | 30.1 MB 29.5 MB/s eta 0:00:04               | 39.2 MB 19.8 MB/s eta 0:00:05     |██████████▉                     | 42.0 MB 19.8 MB/s eta 0:00:05��██████▍                    | 44.1 MB 19.8 MB/s eta 0:00:05     |███████████▋                    | 45.2 MB 19.8 MB/s eta 0:00:04████████████▏                   | 47.2 MB 19.8 MB/s eta 0:00:04��███████████▍                   | 48.2 MB 19.8 MB/s eta 0:00:04     |████████████▊                   | 49.2 MB 19.8 MB/s eta 0:00:04��▊                   | 49.6 MB 19.8 MB/s eta 0:00:04   | 50.8 MB 19.8 MB/s eta 0:00:04�███▏                  | 51.2 MB 19.8 MB/s eta 0:00:047         | 53.0 MB 10.9 MB/s eta 0:00:07�█████████▊                  | 53.4 MB 10.9 MB/s eta 0:00:07�███                  | 54.3 MB 10.9 MB/s eta 0:00:07[K     |██████████████                  | 54.7 MB 10.9 MB/s eta 0:00:07K     |██████████████▏                 | 55.1 MB 10.9 MB/s eta 0:00:07/s eta 0:00:07| 55.8 MB 10.9 MB/s eta 0:00:0700:07 MB/s eta 0:00:07███████████████▎                | 59.1 MB 10.9 MB/s eta 0:00:06��█████▋               | 64.6 MB 17.4 MB/s eta 0:00:04     |█████████████████████▎          | 82.7 MB 17.4 MB/s eta 0:00:03�▌          | 83.6 MB 7.1 MB/s eta 0:00:06     |████████████████████████        | 92.9 MB 7.1 MB/s eta 0:00:05�████████████▊      | 99.7 MB 7.1 MB/s eta 0:00:04��█████      | 100.5 MB 37.1 MB/s eta 0:00:01█████████████▎     | 102.0 MB 37.1 MB/s eta 0:00:0101| 105.8 MB 37.1 MB/s eta 0:00:01█▌    | 106.6 MB 37.1 MB/s eta 0:00:01��█████   | 112.9 MB 37.1 MB/s eta 0:00:01�█████████████▊ | 119.1 MB 7.1 MB/s eta 0:00:01██████████████████████████████▊ | 119.4 MB 7.1 MB/s eta 0:00:01��█▉ | 119.7 MB 7.1 MB/s eta 0:00:01�████████████████▎| 121.4 MB 7.1 MB/s eta 0:00:01��███████▋| 122.5 MB 7.1 MB/s eta 0:00:01
?25hCollecting nvidia-cublas-cu12==12.1.3.1; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
  Downloading nvidia_cublas_cu12-12.1.3.1-py3-none-manylinux1_x86_64.whl (410.6 MB)
     |████████████████████████████████| 410.6 MB 9.4 kB/s  eta 0:00:01 28.2 MB/s eta 0:00:15 MB 28.2 MB/s eta 0:00:1521.3 MB 9.5 MB/s eta 0:00:41                          | 21.8 MB 9.5 MB/s eta 0:00:4138.7 MB 26.1 MB/s eta 0:00:15                       | 39.2 MB 26.1 MB/s eta 0:00:156.1 MB/s eta 0:00:15                   | 42.5 MB 26.1 MB/s eta 0:00:15     |███▌                            | 45.1 MB 26.1 MB/s eta 0:00:15     |███▉                            | 48.7 MB 26.1 MB/s eta 0:00:14███                           | 63.8 MB 22.1 MB/s eta 0:00:16  | 72.3 MB 5.8 MB/s eta 0:00:59 eta 0:00:595.8 MB/s eta 0:00:57220:22                | 96.7 MB 14.7 MB/s eta 0:00:22                | 97.9 MB 14.7 MB/s eta 0:00:22                     | 98.4 MB 14.7 MB/s eta 0:00:22��                        | 98.8 MB 14.7 MB/s eta 0:00:22                | 109.9 MB 17.9 MB/s eta 0:00:17MB 17.9 MB/s eta 0:00:17��████▊                       | 112.3 MB 17.9 MB/s eta 0:00:172.7 MB 17.9 MB/s eta 0:00:17██████▉                       | 113.2 MB 17.9 MB/s eta 0:00:17     |█████████▌                      | 122.6 MB 6.7 MB/s eta 0:00:43[K     |█████████▊                      | 125.2 MB 6.7 MB/s eta 0:00:43K     |█████████▉                      | 125.6 MB 6.7 MB/s eta 0:00:43        | 127.6 MB 6.7 MB/s eta 0:00:42██████████▎                     | 132.2 MB 6.7 MB/s eta 0:00:42��██████▍                     | 132.6 MB 6.7 MB/s eta 0:00:42�███▍                     | 133.1 MB 6.7 MB/s eta 0:00:42| 137.3 MB 37.9 MB/s eta 0:00:08��██▊                     | 137.7 MB 37.9 MB/s eta 0:00:08��██▉                     | 139.0 MB 37.9 MB/s eta 0:00:08     |████████████                    | 154.0 MB 36.3 MB/s eta 0:00:080:080:080:080:070:070:07█████████▎                  | 169.7 MB 36.3 MB/s eta 0:00:071 MB/s eta 0:00:10        | 177.3 MB 25.1 MB/s eta 0:00:10�█▍                 | 184.6 MB 25.1 MB/s eta 0:00:10 MB/s eta 0:00:26   | 192.4 MB 8.4 MB/s eta 0:00:26█                 | 192.8 MB 8.4 MB/s eta 0:00:26███████████████▏                | 195.1 MB 8.4 MB/s eta 0:00:26��███████████▎                | 195.5 MB 8.4 MB/s eta 0:00:26�████████▎                | 195.9 MB 8.4 MB/s eta 0:00:26     |███████████████▌                | 198.4 MB 8.4 MB/s eta 0:00:26████████████████                | 204.2 MB 8.4 MB/s eta 0:00:25 |████████████████▉               | 215.3 MB 20.1 MB/s eta 0:00:10�███████████████▉               | 215.7 MB 20.1 MB/s eta 0:00:10 |█████████████████               | 218.3 MB 20.1 MB/s eta 0:00:10███████████████               | 219.1 MB 20.1 MB/s eta 0:00:10███████▏              | 220.5 MB 20.1 MB/s eta 0:00:10220.9 MB 20.1 MB/s eta 0:00:10    |█████████████████▌              | 224.6 MB 9.1 MB/s eta 0:00:2125.0 MB 9.1 MB/s eta 0:00:21��██▋              | 226.0 MB 9.1 MB/s eta 0:00:21  | 231.0 MB 9.1 MB/s eta 0:00:20�████████████████              | 232.3 MB 9.1 MB/s eta 0:00:20��███████████████▋            | 251.6 MB 25.0 MB/s eta 0:00:07█████████▊            | 252.4 MB 25.0 MB/s eta 0:00:07��█████▊            | 252.7 MB 25.0 MB/s eta 0:00:07�██▊            | 253.1 MB 25.0 MB/s eta 0:00:07/s eta 0:00:07�█████████           | 268.7 MB 1.1 MB/s eta 0:02:05��█████████████████           | 269.0 MB 1.1 MB/s eta 0:02:0502:05ta 0:02:04[K     |█████████████████████▏          | 271.4 MB 42.4 MB/s eta 0:00:04ta 0:00:042.3 MB 42.4 MB/s eta 0:00:04        | 272.6 MB 42.4 MB/s eta 0:00:04�██▎          | 273.0 MB 42.4 MB/s eta 0:00:04     |█████████████████████▉          | 280.8 MB 42.4 MB/s eta 0:00:04MB 42.4 MB/s eta 0:00:04    | 283.3 MB 42.4 MB/s eta 0:00:04██          | 283.6 MB 42.4 MB/s eta 0:00:03████████████▎         | 285.5 MB 42.4 MB/s eta 0:00:03████████████▋         | 290.4 MB 22.1 MB/s eta 0:00:06        | 293.0 MB 22.1 MB/s eta 0:00:06████████████▉         | 293.7 MB 22.1 MB/s eta 0:00:06     |███████████████████████         | 295.5 MB 22.1 MB/s eta 0:00:06��███████████         | 295.8 MB 22.1 MB/s eta 0:00:06ta 0:00:06    | 297.2 MB 22.1 MB/s eta 0:00:06�██████▏        | 297.5 MB 22.1 MB/s eta 0:00:06███████████████▏        | 297.8 MB 22.1 MB/s eta 0:00:06 |███████████████████████▎        | 298.2 MB 22.1 MB/s eta 0:00:061 MB/s eta 0:00:064 MB 22.1 MB/s eta 0:00:06███▍        | 299.7 MB 22.1 MB/s eta 0:00:066 MB 20.6 MB/s eta 0:00:06  | 303.3 MB 20.6 MB/s eta 0:00:06███████████████████▊        | 304.9 MB 20.6 MB/s eta 0:00:06��▊       | 316.7 MB 20.6 MB/s eta 0:00:05��█████████████████       | 321.6 MB 16.8 MB/s eta 0:00:06███████       | 322.0 MB 16.8 MB/s eta 0:00:06| 323.8 MB 16.8 MB/s eta 0:00:06| 327.3 MB 16.8 MB/s eta 0:00:05��███████▌      | 327.7 MB 16.8 MB/s eta 0:00:05     |█████████████████████████▉      | 331.8 MB 16.8 MB/s eta 0:00:052.1 MB 16.8 MB/s eta 0:00:05�███████      | 332.4 MB 16.8 MB/s eta 0:00:05████████      | 333.7 MB 16.8 MB/s eta 0:00:05��██████████████████▏     | 335.8 MB 16.8 MB/s eta 0:00:05��██████████████████▋     | 341.5 MB 27.6 MB/s eta 0:00:03��██▊     | 342.6 MB 27.6 MB/s eta 0:00:03████████▉     | 344.7 MB 27.6 MB/s eta 0:00:03��███████████████████     | 347.1 MB 27.6 MB/s eta 0:00:03| 347.7 MB 27.6 MB/s eta 0:00:03��████████▋    | 355.0 MB 8.4 MB/s eta 0:00:07�████████▊    | 355.3 MB 8.4 MB/s eta 0:00:07[K     |███████████████████████████▉    | 357.2 MB 8.4 MB/s eta 0:00:07�████████    | 357.9 MB 8.4 MB/s eta 0:00:07K     |████████████████████████████    | 359.7 MB 8.4 MB/s eta 0:00:07     |████████████████████████████    | 360.1 MB 8.4 MB/s eta 0:00:07    |████████████████████████████    | 360.4 MB 8.4 MB/s eta 0:00:06   |████████████████████████████    | 360.7 MB 8.4 MB/s eta 0:00:06�█████▏   | 361.0 MB 8.4 MB/s eta 0:00:06��█████████████████████████▏   | 361.3 MB 8.4 MB/s eta 0:00:06████████▏   | 361.8 MB 7.6 MB/s eta 0:00:07|████████████████████████████▎   | 362.1 MB 7.6 MB/s eta 0:00:07██▎   | 363.1 MB 7.6 MB/s eta 0:00:07████████▍   | 364.6 MB 7.6 MB/s eta 0:00:07████████▌   | 366.3 MB 7.6 MB/s eta 0:00:06████████▉   | 369.6 MB 7.6 MB/s eta 0:00:06|████████████████████████████▉   | 369.9 MB 7.6 MB/s eta 0:00:06 MB/s eta 0:00:06��██████████████   | 372.1 MB 7.6 MB/s eta 0:00:06     |█████████████████████████████▏  | 374.7 MB 7.6 MB/s eta 0:00:05█████████████████████████████▎  | 376.4 MB 7.6 MB/s eta 0:00:050.3 MB/s eta 0:00:020.3 MB/s eta 0:00:02�████▊  | 381.6 MB 20.3 MB/s eta 0:00:020.3 MB/s eta 0:00:020.3 MB/s eta 0:00:02��██████████████▏ | 387.8 MB 20.3 MB/s eta 0:00:02��██████████████▌ | 390.9 MB 20.3 MB/s eta 0:00:01�█████████████████▉ | 395.1 MB 28.4 MB/s eta 0:00:01MB 28.4 MB/s eta 0:00:01��███████████████████████ | 397.6 MB 28.4 MB/s eta 0:00:010101�██████████████▊| 407.3 MB 28.4 MB/s eta 0:00:0101�█████████████| 410.2 MB 28.4 MB/s eta 0:00:01██████████████| 410.5 MB 28.4 MB/s eta 0:00:01
?25hCollecting sympy
  Downloading sympy-1.12-py3-none-any.whl (5.7 MB)
     |████████████████████████████████| 5.7 MB 57.4 MB/s eta 0:00:017.4 MB/s eta 0:00:01
?25hCollecting nvidia-nvtx-cu12==12.1.105; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
  Downloading nvidia_nvtx_cu12-12.1.105-py3-none-manylinux1_x86_64.whl (99 kB)
     |████████████████████████████████| 99 kB 2.1 MB/s eta 0:00:011
?25hCollecting nvidia-nccl-cu12==2.20.5; platform_system == &quot;Linux&quot; and platform_machine == &quot;x86_64&quot;
  Downloading nvidia_nccl_cu12-2.20.5-py3-none-manylinux2014_x86_64.whl (176.2 MB)
     |████████████████████████████████| 176.2 MB 167 kB/s eta 0:00:0118 MB 27.9 MB/s eta 0:00:07                          | 8.3 MB 27.9 MB/s eta 0:00:07 0:00:0600:06   | 12.5 MB 27.9 MB/s eta 0:00:06▍                             | 13.1 MB 27.9 MB/s eta 0:00:06s eta 0:00:06           | 14.1 MB 27.9 MB/s eta 0:00:06     |██▉                             | 15.4 MB 27.9 MB/s eta 0:00:06      | 17.3 MB 864 kB/s eta 0:03:04      | 17.8 MB 864 kB/s eta 0:03:04      | 18.3 MB 864 kB/s eta 0:03:03      | 18.8 MB 864 kB/s eta 0:03:03      | 19.3 MB 864 kB/s eta 0:03:02  | 30.6 MB 864 kB/s eta 0:02:49��█▋                          | 31.1 MB 864 kB/s eta 0:02:487 MB/s eta 0:00:0504 0:00:04ta 0:00:04 eta 0:00:0400:04�█▋                        | 41.8 MB 35.7 MB/s eta 0:00:04███▊                        | 42.3 MB 35.7 MB/s eta 0:00:0404:00:04ta 0:00:040:044 MB/s eta 0:00:09��▏                      | 50.4 MB 14.4 MB/s eta 0:00:09███████████                     | 60.4 MB 14.4 MB/s eta 0:00:09��███████                     | 60.9 MB 14.4 MB/s eta 0:00:09███████████▏                    | 61.3 MB 14.4 MB/s eta 0:00:09 MB/s eta 0:00:08████████████████                | 87.8 MB 12.4 MB/s eta 0:00:08��████████████                | 88.2 MB 12.4 MB/s eta 0:00:08�█████████                | 88.6 MB 12.4 MB/s eta 0:00:08 0:00:08 MB 12.4 MB/s eta 0:00:07| 100.4 MB 12.4 MB/s eta 0:00:07▎             | 100.7 MB 8.7 MB/s eta 0:00:09            | 101.1 MB 8.7 MB/s eta 0:00:09        | 101.5 MB 8.7 MB/s eta 0:00:09    | 101.8 MB 8.7 MB/s eta 0:00:09███████████████████             | 105.2 MB 8.7 MB/s eta 0:00:09 eta 0:00:08��████████████████▍           | 112.1 MB 8.7 MB/s eta 0:00:0800:08 112.8 MB 8.7 MB/s eta 0:00:08��████████████████▉           | 114.8 MB 8.7 MB/s eta 0:00:08█████████████████▎          | 117.1 MB 16.0 MB/s eta 0:00:04 eta 0:00:04████          | 121.8 MB 16.0 MB/s eta 0:00:04████████████▍         | 123.1 MB 16.0 MB/s eta 0:00:04        | 123.5 MB 16.0 MB/s eta 0:00:04████████████▌         | 124.2 MB 16.0 MB/s eta 0:00:04        | 124.5 MB 16.0 MB/s eta 0:00:04        | 125.1 MB 16.0 MB/s eta 0:00:04█████████████         | 126.3 MB 16.0 MB/s eta 0:00:04        | 126.6 MB 16.0 MB/s eta 0:00:04  |███████████████████████▌        | 129.3 MB 478 kB/s eta 0:01:39154.4 MB 18.0 MB/s eta 0:00:02████████    | 154.7 MB 18.0 MB/s eta 0:00:02████████████████████████████▏   | 155.0 MB 18.0 MB/s eta 0:00:02�████████████   | 159.2 MB 18.0 MB/s eta 0:00:01| 159.5 MB 18.0 MB/s eta 0:00:01�████████▏  | 160.4 MB 18.0 MB/s eta 0:00:01��███████▋  | 163.1 MB 31.9 MB/s eta 0:00:01��██████████████████████▍ | 167.6 MB 31.9 MB/s eta 0:00:01████▌ | 167.9 MB 31.9 MB/s eta 0:00:01��██████████████▋ | 168.7 MB 31.9 MB/s eta 0:00:01�█████████▊ | 169.2 MB 31.9 MB/s eta 0:00:01��██████████████████████▊ | 169.3 MB 31.9 MB/s eta 0:00:01████▉ | 169.6 MB 31.9 MB/s eta 0:00:01��███████████████ | 170.3 MB 31.9 MB/s eta 0:00:01MB 31.9 MB/s eta 0:00:01��███████████████████████ | 170.9 MB 31.9 MB/s eta 0:00:01█████ | 171.2 MB 31.9 MB/s eta 0:00:01MB/s eta 0:00:01�███████▏| 171.7 MB 298 kB/s eta 0:00:16172.0 MB 298 kB/s eta 0:00:1514██████████████████████████▍| 172.6 MB 298 kB/s eta 0:00:13█████████████████▍| 172.9 MB 298 kB/s eta 0:00:12███████▍| 173.1 MB 298 kB/s eta 0:00:1173.4 MB 298 kB/s eta 0:00:109��█████████████████████████▋| 174.0 MB 298 kB/s eta 0:00:08��████████████████▋| 174.3 MB 298 kB/s eta 0:00:07�█████████████████████████▊| 174.8 MB 298 kB/s eta 0:00:05
?25hRequirement already satisfied: requests in /usr/local/lib/python3.8/dist-packages (from huggingface-hub-&gt;accelerate) (2.31.0)
Requirement already satisfied: tqdm&gt;=4.42.1 in /home/rtabares/.local/lib/python3.8/site-packages (from huggingface-hub-&gt;accelerate) (4.66.2)
Collecting nvidia-nvjitlink-cu12
  Downloading nvidia_nvjitlink_cu12-12.4.127-py3-none-manylinux2014_x86_64.whl (21.1 MB)
     |████████████████████████████████| 21.1 MB 6.1 MB/s eta 0:00:01     |████████████████████████████▌   | 18.7 MB 6.1 MB/s eta 0:00:01
?25hRequirement already satisfied: MarkupSafe&gt;=2.0 in /usr/local/lib/python3.8/dist-packages (from jinja2-&gt;torch&gt;=1.10.0-&gt;accelerate) (2.1.3)
Collecting mpmath&gt;=0.19
  Downloading mpmath-1.3.0-py3-none-any.whl (536 kB)
     |████████████████████████████████| 536 kB 18.6 MB/s eta 0:00:01
?25hRequirement already satisfied: certifi&gt;=2017.4.17 in /usr/lib/python3/dist-packages (from requests-&gt;huggingface-hub-&gt;accelerate) (2019.11.28)
Requirement already satisfied: charset-normalizer&lt;4,&gt;=2 in /usr/local/lib/python3.8/dist-packages (from requests-&gt;huggingface-hub-&gt;accelerate) (3.3.2)
Requirement already satisfied: urllib3&lt;3,&gt;=1.21.1 in /usr/lib/python3/dist-packages (from requests-&gt;huggingface-hub-&gt;accelerate) (1.25.8)
Requirement already satisfied: idna&lt;4,&gt;=2.5 in /usr/lib/python3/dist-packages (from requests-&gt;huggingface-hub-&gt;accelerate) (2.8)
Installing collected packages: nvidia-cublas-cu12, nvidia-cudnn-cu12, triton, nvidia-cuda-runtime-cu12, networkx, nvidia-cuda-cupti-cu12, nvidia-cuda-nvrtc-cu12, nvidia-nvjitlink-cu12, nvidia-cusparse-cu12, nvidia-curand-cu12, nvidia-cufft-cu12, nvidia-cusolver-cu12, mpmath, sympy, nvidia-nvtx-cu12, nvidia-nccl-cu12, torch, accelerate
Successfully installed accelerate-0.30.1 mpmath-1.3.0 networkx-3.1 nvidia-cublas-cu12-12.1.3.1 nvidia-cuda-cupti-cu12-12.1.105 nvidia-cuda-nvrtc-cu12-12.1.105 nvidia-cuda-runtime-cu12-12.1.105 nvidia-cudnn-cu12-8.9.2.26 nvidia-cufft-cu12-11.0.2.54 nvidia-curand-cu12-10.3.2.106 nvidia-cusolver-cu12-11.4.5.107 nvidia-cusparse-cu12-12.1.0.106 nvidia-nccl-cu12-2.20.5 nvidia-nvjitlink-cu12-12.4.127 nvidia-nvtx-cu12-12.1.105 sympy-1.12 torch-2.3.0 triton-2.3.0
</pre></div>
</div>
</div>
</div>
</section>
<section id="carga-de-librerias">
<h2>Carga de librerías<a class="headerlink" href="#carga-de-librerias" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Importando la biblioteca PyTorch para construir y entrenar redes neuronales</span>
<span class="kn">import</span> <span class="nn">torch</span>

<span class="c1"># Importando StableDiffusionPipeline para utilizar modelos preentrenados de Stable Diffusion</span>
<span class="kn">from</span> <span class="nn">diffusers</span> <span class="kn">import</span> <span class="n">StableDiffusionPipeline</span>

<span class="c1"># Image es una clase del módulo PIL para visualizar imágenes en un cuaderno de Python</span>
<span class="kn">from</span> <span class="nn">PIL</span> <span class="kn">import</span> <span class="n">Image</span>

<span class="c1"># Para medir tiempos</span>
<span class="kn">import</span> <span class="nn">time</span>

<span class="c1"># Mostrar imágenes</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
</pre></div>
</div>
</div>
</div>
</section>
<section id="verificacion-de-gpu-y-cuda">
<h2>Verificación de GPU y CUDA<a class="headerlink" href="#verificacion-de-gpu-y-cuda" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="kn">import</span> <span class="nn">pycuda.driver</span> <span class="k">as</span> <span class="nn">drv</span>
<span class="kn">import</span> <span class="nn">pycuda.autoinit</span>
<span class="n">drv</span><span class="o">.</span><span class="n">init</span><span class="p">()</span>
<span class="nb">print</span><span class="p">(</span><span class="s2">&quot;</span><span class="si">%d</span><span class="s2"> device(s) found.&quot;</span> <span class="o">%</span> <span class="n">drv</span><span class="o">.</span><span class="n">Device</span><span class="o">.</span><span class="n">count</span><span class="p">())</span>
<span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="n">drv</span><span class="o">.</span><span class="n">Device</span><span class="o">.</span><span class="n">count</span><span class="p">()):</span>
  <span class="n">dev</span> <span class="o">=</span> <span class="n">drv</span><span class="o">.</span><span class="n">Device</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Device #</span><span class="si">%d</span><span class="s2">: </span><span class="si">%s</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">i</span><span class="p">,</span> <span class="n">dev</span><span class="o">.</span><span class="n">name</span><span class="p">()))</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Compute Capability: </span><span class="si">%d</span><span class="s2">.</span><span class="si">%d</span><span class="s2">&quot;</span> <span class="o">%</span> <span class="n">dev</span><span class="o">.</span><span class="n">compute_capability</span><span class="p">())</span>
  <span class="nb">print</span><span class="p">(</span><span class="s2">&quot; Total Memory: </span><span class="si">%s</span><span class="s2"> GB&quot;</span> <span class="o">%</span> <span class="p">(</span><span class="n">dev</span><span class="o">.</span><span class="n">total_memory</span><span class="p">()</span> <span class="o">//</span> <span class="p">(</span><span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span> <span class="o">*</span> <span class="mi">1024</span><span class="p">)))</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>1 device(s) found.
 Device #0: NVIDIA GeForce GTX 1070 with Max-Q Design
 Compute Capability: 6.1
 Total Memory: 7 GB
</pre></div>
</div>
</div>
</div>
</section>
</section>
<section class="tex2jax_ignore mathjax_ignore" id="stable-diffusion-funciones">
<h1>Stable Diffusion funciones<a class="headerlink" href="#stable-diffusion-funciones" title="Link to this heading">#</a></h1>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="k">def</span> <span class="nf">generate_image_grid</span><span class="p">(</span><span class="n">text_prompt</span><span class="p">,</span> <span class="n">n_images</span><span class="o">=</span><span class="mi">4</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">200</span><span class="p">,</span> <span class="mi">200</span><span class="p">)):</span>
    <span class="n">prompt</span> <span class="o">=</span> <span class="p">[</span><span class="n">text_prompt</span><span class="p">]</span> <span class="o">*</span> <span class="n">n_images</span>
    <span class="n">images</span> <span class="o">=</span> <span class="n">pipeline</span><span class="p">(</span><span class="n">prompt</span><span class="p">)</span><span class="o">.</span><span class="n">images</span>

    <span class="c1"># Verifica si la cuadrícula tiene un solo elemento</span>
    <span class="k">if</span> <span class="n">n_images</span> <span class="o">==</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">return</span> <span class="n">images</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>

    <span class="c1"># Muestra las imágenes por separado con matplotlib</span>
    <span class="n">fig</span><span class="p">,</span> <span class="n">axs</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">(</span><span class="n">rows</span><span class="p">,</span> <span class="n">cols</span><span class="p">,</span> <span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">8</span><span class="p">,</span> <span class="mi">8</span><span class="p">))</span>

    <span class="k">for</span> <span class="n">i</span><span class="p">,</span> <span class="n">ax</span> <span class="ow">in</span> <span class="nb">enumerate</span><span class="p">(</span><span class="n">axs</span><span class="o">.</span><span class="n">flat</span><span class="p">):</span>
        <span class="c1"># Si hay menos imágenes que elementos en la cuadrícula, oculta los ejes sobrantes</span>
        <span class="k">if</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="nb">len</span><span class="p">(</span><span class="n">images</span><span class="p">):</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">imshow</span><span class="p">(</span><span class="n">images</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">ax</span><span class="o">.</span><span class="n">axis</span><span class="p">(</span><span class="s1">&#39;off&#39;</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>
<section id="stable-diffusion-en-gpu">
<h2>Stable Diffusion en GPU<a class="headerlink" href="#stable-diffusion-en-gpu" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating the pipeline for GPU</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">StableDiffusionPipeline</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;CompVis/stable-diffusion-v1-4&quot;</span><span class="p">,</span><span class="n">torch_dtype</span><span class="o">=</span><span class="n">torch</span><span class="o">.</span><span class="n">float16</span><span class="p">)</span>
<span class="c1"># Moving pipeline to GPU</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">pipeline</span><span class="o">.</span><span class="n">to</span><span class="p">(</span><span class="s1">&#39;cuda&#39;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading pipeline components...: 100%|██████████| 7/7 [00:02&lt;00:00,  3.02it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt</span> <span class="o">=</span> <span class="s1">&#39;a cute magical flying german shepherd puppy wearing a superman cape, </span><span class="se">\</span>
<span class="s1">fantasy art drawn by disney concept artists, golden colour, high quality, </span><span class="se">\</span>
<span class="s1">highly detailed, elegant, sharp focus, concept art, character concepts, </span><span class="se">\</span>
<span class="s1">digital painting, mystery, adventure&#39;</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">generate_image_grid</span><span class="p">(</span><span class="n">text_prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">,</span> <span class="n">n_images</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span><span class="o">=</span><span class="mi">2</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span>

<span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">elapsed_timeGPU</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tiempo transcurrido: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">elapsed_timeGPU</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> segundos&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tiempo transcurrido: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">elapsed_timeGPU</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> minutos&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 50/50 [05:28&lt;00:00,  6.58s/it]
</pre></div>
</div>
<img alt="../../_images/16f5b3048ccbbcc7a16f7725ed796af1fc33af115526476298e56cb074c3d7cc.png" src="../../_images/16f5b3048ccbbcc7a16f7725ed796af1fc33af115526476298e56cb074c3d7cc.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tiempo transcurrido: 331.58 segundos
Tiempo transcurrido: 5.53 minutos
</pre></div>
</div>
</div>
</div>
</section>
<section id="stable-diffusion-en-cpu">
<h2>Stable Diffusion en CPU<a class="headerlink" href="#stable-diffusion-en-cpu" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="c1"># Creating the pipeline for CPU</span>
<span class="n">pipeline</span> <span class="o">=</span> <span class="n">StableDiffusionPipeline</span><span class="o">.</span><span class="n">from_pretrained</span><span class="p">(</span><span class="s2">&quot;CompVis/stable-diffusion-v1-4&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Loading pipeline components...: 100%|██████████| 7/7 [00:01&lt;00:00,  4.46it/s]
</pre></div>
</div>
</div>
</div>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">prompt</span> <span class="o">=</span> <span class="s1">&#39;a cute magical flying german shepherd puppy wearing a superman cape, </span><span class="se">\</span>
<span class="s1">fantasy art drawn by disney concept artists, golden colour, high quality, </span><span class="se">\</span>
<span class="s1">highly detailed, elegant, sharp focus, concept art, character concepts, </span><span class="se">\</span>
<span class="s1">digital painting, mystery, adventure&#39;</span>

<span class="n">start_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>

<span class="n">generate_image_grid</span><span class="p">(</span><span class="n">text_prompt</span><span class="o">=</span><span class="n">prompt</span><span class="p">,</span> <span class="n">n_images</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span>  <span class="n">rows</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">cols</span> <span class="o">=</span> <span class="mi">2</span><span class="p">,</span> <span class="n">output_size</span><span class="o">=</span><span class="p">(</span><span class="mi">512</span><span class="p">,</span> <span class="mi">512</span><span class="p">))</span>

<span class="n">end_time</span> <span class="o">=</span> <span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">()</span>
<span class="n">elapsed_timeCPU</span> <span class="o">=</span> <span class="n">end_time</span> <span class="o">-</span> <span class="n">start_time</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tiempo transcurrido: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">elapsed_timeCPU</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> segundos&quot;</span><span class="p">)</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;Tiempo transcurrido: </span><span class="si">{</span><span class="nb">round</span><span class="p">(</span><span class="n">elapsed_timeCPU</span><span class="w"> </span><span class="o">/</span><span class="w"> </span><span class="mi">60</span><span class="p">,</span><span class="w"> </span><span class="mi">2</span><span class="p">)</span><span class="si">}</span><span class="s2"> minutos&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stderr highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>100%|██████████| 50/50 [22:15&lt;00:00, 26.72s/it]
</pre></div>
</div>
<img alt="../../_images/8dc38648fb8a60e1229cd3faf689968474f437f61b1ab841984909390cc6e12a.png" src="../../_images/8dc38648fb8a60e1229cd3faf689968474f437f61b1ab841984909390cc6e12a.png" />
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>Tiempo transcurrido: 1365.03 segundos
Tiempo transcurrido: 22.75 minutos
</pre></div>
</div>
</div>
</div>
</section>
<section id="comparemos-la-gpu-con-la-cpu">
<h2>Comparemos la GPU con la CPU<a class="headerlink" href="#comparemos-la-gpu-con-la-cpu" title="Link to this heading">#</a></h2>
<div class="cell docutils container">
<div class="cell_input docutils container">
<div class="highlight-ipython3 notranslate"><div class="highlight"><pre><span></span><span class="n">speedup_factor</span> <span class="o">=</span> <span class="n">elapsed_timeCPU</span> <span class="o">/</span> <span class="n">elapsed_timeGPU</span>
<span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;La ejecución en GPU fue aproximadamente </span><span class="si">{</span><span class="n">speedup_factor</span><span class="si">:</span><span class="s2">.2f</span><span class="si">}</span><span class="s2"> veces más rápida que en CPU.&quot;</span><span class="p">)</span>
</pre></div>
</div>
</div>
<div class="cell_output docutils container">
<div class="output stream highlight-myst-ansi notranslate"><div class="highlight"><pre><span></span>La ejecución en GPU fue aproximadamente 4.14 veces más rápida que en CPU.
</pre></div>
</div>
</div>
</div>
</section>
</section>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            name: "python3",
            path: "./Unidades/Unidad_10"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

                </article>
              

              
              
              
              
                <footer class="prev-next-footer d-print-none">
                  
<div class="prev-next-area">
</div>
                </footer>
              
            </div>
            
            
              
                <div class="bd-sidebar-secondary bd-toc"><div class="sidebar-secondary-items sidebar-secondary__inner">


  <div class="sidebar-secondary-item">
  <div class="page-toc tocsection onthispage">
    <i class="fa-solid fa-list"></i> Contenido
  </div>
  <nav class="bd-toc-nav page-toc">
    <ul class="visible nav section-nav flex-column">
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#">Stable_Diffusion_GPU_vs_CPU</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stable-diffusion-usando-una-gpu-en-google-colaboratory-con-cuda">Stable Diffusion usando una GPU en Google Colaboratory con CUDA</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#recuerda-activar-un-entorno-de-ejecucion-con-gpu">Recuerda activar un <strong>Entorno de ejecución</strong> con GPU.</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#instalacion-de-librerias">Instalación de librerías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#carga-de-librerias">Carga de librerías</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#verificacion-de-gpu-y-cuda">Verificación de GPU y CUDA</a></li>
</ul>
</li>
<li class="toc-h1 nav-item toc-entry"><a class="reference internal nav-link" href="#stable-diffusion-funciones">Stable Diffusion funciones</a><ul class="visible nav section-nav flex-column">
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stable-diffusion-en-gpu">Stable Diffusion en GPU</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#stable-diffusion-en-cpu">Stable Diffusion en CPU</a></li>
<li class="toc-h2 nav-item toc-entry"><a class="reference internal nav-link" href="#comparemos-la-gpu-con-la-cpu">Comparemos la GPU con la CPU</a></li>
</ul>
</li>
</ul>

  </nav></div>

</div></div>
              
            
          </div>
          <footer class="bd-footer-content">
            
<div class="bd-footer-content__inner container">
  
  <div class="footer-item">
    
<p class="component-author">
Por Johan Piña, Mario Bravo
</p>

  </div>
  
  <div class="footer-item">
    

  <p class="copyright">
    
      © Copyright 2025.
      <br/>
    
  </p>

  </div>
  
  <div class="footer-item">
    
  </div>
  
  <div class="footer-item">
    
  </div>
  
</div>
          </footer>
        

      </main>
    </div>
  </div>
  
  <!-- Scripts loaded after <body> so the DOM is not blocked -->
  <script src="../../_static/scripts/bootstrap.js?digest=dfe6caa3a7d634c4db9b"></script>
<script src="../../_static/scripts/pydata-sphinx-theme.js?digest=dfe6caa3a7d634c4db9b"></script>

  <footer class="bd-footer">
  </footer>
  </body>
</html>